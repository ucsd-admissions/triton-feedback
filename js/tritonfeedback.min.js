!function(e,t,r){"use strict";function n(e){var r=[];return c(r,t.noop).chars(e),r.join("")}function i(e){var t={};e=e.split(",");var r;for(r=0;r<e.length;r++)t[e[r]]=!0;return t}function a(e,r){function n(e,n,a,s){if(n=t.lowercase(n),k[n])for(;w.last()&&N[w.last()];)i("",w.last());I[n]&&w.last()==n&&i("",n),(s=O[n]||!!s)||w.push(n);var c={};a.replace(b,function(e,t,r,n,i){c[t]=o(r||n||i||"")}),r.start&&r.start(n,c,s)}function i(e,n){var i,a=0;if(n=t.lowercase(n))for(a=w.length-1;a>=0&&w[a]!=n;a--);if(a>=0){for(i=w.length-1;i>=a;i--)r.end&&r.end(w[i]);w.length=a}}"string"!=typeof e&&(e=null===e||"undefined"==typeof e?"":""+e);var a,s,c,w=[],v=e;for(w.last=function(){return w[w.length-1]};e;){if(c="",s=!0,w.last()&&S[w.last()]?(e=e.replace(new RegExp("(.*)<\\s*\\/\\s*"+w.last()+"[^>]*>","i"),function(e,t){return t=t.replace(p,"$1").replace(m,"$1"),r.chars&&r.chars(o(t)),""}),i("",w.last())):(0===e.indexOf("<!--")?(a=e.indexOf("--",4),a>=0&&e.lastIndexOf("-->",a)===a&&(r.comment&&r.comment(e.substring(4,a)),e=e.substring(a+3),s=!1)):g.test(e)?(a=e.match(g))&&(e=e.replace(a[0],""),s=!1):h.test(e)?(a=e.match(d))&&(e=e.substring(a[0].length),a[0].replace(d,i),s=!1):f.test(e)&&((a=e.match(u))?(a[4]&&(e=e.substring(a[0].length),a[0].replace(u,n)),s=!1):(c+="<",e=e.substring(1))),s&&(a=e.indexOf("<"),c+=0>a?e:e.substring(0,a),e=0>a?"":e.substring(a),r.chars&&r.chars(o(c)))),e==v)throw l("badparse",e);v=e}i()}function o(e){if(!e)return"";var t=A.exec(e);e=t[1];var r=t[3];return(t=t[2])&&(E.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in E?E.textContent:E.innerText),e+t+r}function s(e){return e.replace(/&/g,"&amp;").replace(w,function(e){var t=e.charCodeAt(0);return e=e.charCodeAt(1),"&#"+(1024*(t-55296)+(e-56320)+65536)+";"}).replace(v,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,r){var n=!1,i=t.bind(e,e.push);return{start:function(e,a,o){e=t.lowercase(e),!n&&S[e]&&(n=e),n||!0!==D[e]||(i("<"),i(e),t.forEach(a,function(n,a){var o=t.lowercase(a),c="img"===e&&"src"===o||"background"===o;!0!==x[o]||!0===y[o]&&!r(n,c)||(i(" "),i(a),i('="'),i(s(n)),i('"'))}),i(o?"/>":">"))},end:function(e){e=t.lowercase(e),n||!0!==D[e]||(i("</"),i(e),i(">")),e==n&&(n=!1)},chars:function(e){n||i(s(e))}}}var l=t.$$minErr("$sanitize"),u=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,d=/^<\/\s*([\w:-]+)[^>]*>/,b=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,f=/^</,h=/^<\//,p=/\x3c!--(.*?)--\x3e/g,g=/<!DOCTYPE([^>]*?)>/i,m=/<!\[CDATA\[(.*?)]]\x3e/g,w=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,v=/([^\#-~| |!])/g,O=i("area,br,col,hr,img,wbr");e=i("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),r=i("rp,rt");var I=t.extend({},r,e),k=t.extend({},e,i("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),N=t.extend({},r,i("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var"));e=i("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use");var S=i("script,style"),D=t.extend({},O,k,N,I,e),y=i("background,cite,href,longdesc,src,usemap,xlink:href");e=i("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"),r=i("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan");var x=t.extend({},y,r,e),E=document.createElement("pre"),A=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var r=[];return a(t,c(r,function(t,r){return!/^unsafe/.test(e(t,r))})),r.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var r=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/,i=/^mailto:/;return function(a,o){function s(e){e&&f.push(n(e))}function c(e,r){f.push("<a "),t.isDefined(o)&&f.push('target="',o,'" '),f.push('href="',e.replace(/"/g,"&quot;"),'">'),s(r),f.push("</a>")}if(!a)return a;for(var l,u,d,b=a,f=[];l=b.match(r);)u=l[0],l[2]||l[4]||(u=(l[3]?"http://":"mailto:")+u),d=l.index,s(b.substr(0,d)),c(u,l[0].replace(i,"")),b=b.substring(d+l[0].length);return s(b),e(f.join(""))}}])}(window,window.angular),!function(e){"use strict";e.module("ng.deviceDetector",[]).constant("BROWSERS",{CHROME:"chrome",FIREFOX:"firefox",SAFARI:"safari",OPERA:"opera",IE:"ie",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("DEVICES",{ANDROID:"android",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",BLACKBERRY:"blackberry",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("OS",{WINDOWS:"windows",MAC:"mac",IOS:"ios",ANDROID:"android",LINUX:"linux",UNIX:"unix",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).service("detectUtils",["deviceDetector","DEVICES","BROWSERS","OS",function(e,t,r,n){var i=e;this.isMobile=function(){return"unknown"!==i.device},this.isAndroid=function(){return i.device===t.ANDROID||i.OS===n.ANDROID},this.isIOS=function(){return i.os===n.IOS||i.device===t.IPOD||i.device===t.IPHONE}}]).factory("deviceDetector",["$window","DEVICES","BROWSERS","OS",function(e,t,r,n){var i=e.navigator.userAgent,a={raw:{userAgent:i,os:{},browser:{},device:{}}};return a.raw.os[n.WINDOWS]=/\bWindows\b/.test(i)&&!/\bWindows Phone\b/.test(i),a.raw.os[n.MAC]=/\bMac OS\b/.test(i),a.raw.os[n.IOS]=/\biPad\b/.test(i)||/\biPhone\b/.test(i)||/\biPod\b/.test(i),a.raw.os[n.ANDROID]=/\bAndroid\b/.test(i),a.raw.os[n.LINUX]=/\bLinux\b/.test(i),a.raw.os[n.UNIX]=/\bUNIX\b/.test(i),a.raw.os[n.FIREFOXOS]=/\bFirefox\b/.test(i)&&/\Mobile\b/.test(i),a.raw.os[n.WINDOWSPHONE]=/\bIEMobile\b/.test(i),a.raw.os[n.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(i),a.raw.os[n.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(i),a.raw.browser[r.CHROME]=/\bChrome\b/.test(i)||/\bCriOS\b/.test(i),a.raw.browser[r.FIREFOX]=/\Firefox\b/.test(i),a.raw.browser[r.SAFARI]=/^((?!CriOS).)*\Safari\b.*$/.test(i),a.raw.browser[r.OPERA]=/\Opera\b/.test(i),a.raw.browser[r.IE]=/\bMSIE\b/.test(i)||/\Trident\b/.test(i),a.raw.browser[r.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(i),a.raw.browser[r.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(i),a.raw.device[t.ANDROID]=/\bAndroid\b/.test(i),a.raw.device[t.IPAD]=/\biPad\b/.test(i),a.raw.device[t.IPHONE]=/\biPhone\b/.test(i),a.raw.device[t.IPOD]=/\biPod\b/.test(i),a.raw.device[t.BLACKBERRY]=/\bblackberry\b/.test(i),a.raw.device[t.FIREFOXOS]=/\bFirefox\b/.test(i)&&/\Mobile\b/.test(i),a.raw.device[t.WINDOWSPHONE]=/\bIEMobile\b/.test(i),a.raw.device[t.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(i),a.raw.device[t.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(i),a.os=[n.WINDOWS,n.IOS,n.MAC,n.ANDROID,n.LINUX,n.UNIX,n.FIREFOXOS,n.WINDOWSPHONE,n.PS4,n.VITA].reduce(function(e,t){return e===n.UNKNOWN&&a.raw.os[t]?t:e},n.UNKNOWN),a.browser=[r.CHROME,r.FIREFOX,r.SAFARI,r.OPERA,r.IE,r.PS4,r.VITA].reduce(function(e,t){return e===r.UNKNOWN&&a.raw.browser[t]?t:e},r.UNKNOWN),a.device=[t.ANDROID,t.IPAD,t.IPHONE,t.IPOD,t.BLACKBERRY,t.FIREFOXOS,t.WINDOWSPHONE,t.PS4,t.VITA].reduce(function(e,r){return e===t.UNKNOWN&&a.raw.device[r]?r:e},t.UNKNOWN),a.isMobile=function(){return[t.ANDROID,t.IPAD,t.IPHONE,t.IPOD,t.BLACKBERRY,t.FIREFOXOS,t.WINDOWSPHONE,t.VITA].some(function(e){return a.device==e})},a.isTablet=function(){return[t.IPAD,t.FIREFOXOS].some(function(e){return a.device==e})},a.isDesktop=function(){return[t.PS4,t.UNKNOWN].some(function(e){return a.device==e})},a}]).directive("deviceDetector",["deviceDetector",function(e){return{restrict:"A",link:function(t,r){r.addClass("os-"+e.os),r.addClass("browser-"+e.browser),r.addClass("device-"+e.device)}}}])}(angular),angular.module("tritonFeedback",["ngCookies","ng.deviceDetector","firebase","ngSanitize"]),angular.module("tritonFeedback").controller("mainCtrl",["$scope","$cookies","tritonFeedbackData","deviceDetector","firebaseManager","$timeout","$sce",function(e,t,r,n,i,a){"use strict";var o=this;e.authenticated=!1,e.visible=!1,e.showConfirmation=!1,e.env={browser:n.browser,device:n.device,os:n.os},e.path=window.location.pathname,e.error=!1,e.firebase=i,e.feedback={message:null,category:"broken"},e.wp=null,e.feedbackCategories=["broken","awesome","surprising","confusing","annoying","other"],this.authenticate=function(e){var t=e.triton_feedback_access;return t?!0:!1},this.connect=function(e){var t=new Firebase("https://"+e+".firebaseio.com/");return t?t:null},e.getTemplate=function(){return o.authenticated?e.wp.templateUrl:""},e.open=function(){e.visible=!0,angular.element(document.getElementsByTagName("body")).css("overflow","hidden")},e.close=function(){e.visible=!1,angular.element(document.getElementsByTagName("body")).css("overflow","")},e.submitFeedback=function(){var r=e.firebase.push({time:(new Date).getTime(),session:t.triton_feedback_session,browser:e.env.browser,device:e.env.device,os:e.env.os,path:e.path,message:e.feedback.message,category:e.feedback.category},e.callback);r||e["throw"]()},e.callback=function(t){e.$apply(t?e.error():e.resetFeedback())},e["throw"]=function(){e.error=!0},e.resetFeedback=function(){e.feedback={message:null,category:"broken"},e.showConfirmation=!0,a(function(){e.showConfirmation=!1},5e3)},this.init=function(){if(o.authenticated=o.authenticate(t),o.authenticated){e.wp=r,e.instructions=e.wp.instructions;var n=e.firebase.connect();n||e["throw"]()}},this.init()}]),angular.module("tritonFeedback").factory("tritonFeedbackData",function(){"use strict";return this.defaults={templateUrl:"wp-content/plugins/triton-feedback/src/template.html",firebase:""},"undefined"==typeof tritonFeedbackData?this.defaults:tritonFeedbackData}),angular.module("tritonFeedback").service("firebaseManager",["tritonFeedbackData","$cookies",function(e){"use strict";var t=this;this.firebaseName=e.firebase,this.connection=null,this.connected=!1,this.connect=function(){return t.firebaseName?(t.connection=new Firebase("https://"+t.firebaseName+".firebaseio.com/"),t.connection?!0:!1):!1},this.push=function(e,r){if(!t.connection)return!1;var n=t.connection.child("tickets");return n.push(e,r),!0}}]),angular.bootstrap(document.getElementById("triton-feedback"),["tritonFeedback"]);