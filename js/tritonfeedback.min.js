!function(e){"use strict";e.module("ng.deviceDetector",[]).constant("BROWSERS",{CHROME:"chrome",FIREFOX:"firefox",SAFARI:"safari",OPERA:"opera",IE:"ie",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("DEVICES",{ANDROID:"android",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",BLACKBERRY:"blackberry",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("OS",{WINDOWS:"windows",MAC:"mac",IOS:"ios",ANDROID:"android",LINUX:"linux",UNIX:"unix",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).service("detectUtils",["deviceDetector","DEVICES","BROWSERS","OS",function(e,t,i,r){var n=e;this.isMobile=function(){return"unknown"!==n.device},this.isAndroid=function(){return n.device===t.ANDROID||n.OS===r.ANDROID},this.isIOS=function(){return n.os===r.IOS||n.device===t.IPOD||n.device===t.IPHONE}}]).factory("deviceDetector",["$window","DEVICES","BROWSERS","OS",function(e,t,i,r){var n=e.navigator.userAgent,o={raw:{userAgent:n,os:{},browser:{},device:{}}};return o.raw.os[r.WINDOWS]=/\bWindows\b/.test(n)&&!/\bWindows Phone\b/.test(n),o.raw.os[r.MAC]=/\bMac OS\b/.test(n),o.raw.os[r.IOS]=/\biPad\b/.test(n)||/\biPhone\b/.test(n)||/\biPod\b/.test(n),o.raw.os[r.ANDROID]=/\bAndroid\b/.test(n),o.raw.os[r.LINUX]=/\bLinux\b/.test(n),o.raw.os[r.UNIX]=/\bUNIX\b/.test(n),o.raw.os[r.FIREFOXOS]=/\bFirefox\b/.test(n)&&/\Mobile\b/.test(n),o.raw.os[r.WINDOWSPHONE]=/\bIEMobile\b/.test(n),o.raw.os[r.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(n),o.raw.os[r.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(n),o.raw.browser[i.CHROME]=/\bChrome\b/.test(n)||/\bCriOS\b/.test(n),o.raw.browser[i.FIREFOX]=/\Firefox\b/.test(n),o.raw.browser[i.SAFARI]=/^((?!CriOS).)*\Safari\b.*$/.test(n),o.raw.browser[i.OPERA]=/\Opera\b/.test(n),o.raw.browser[i.IE]=/\bMSIE\b/.test(n)||/\Trident\b/.test(n),o.raw.browser[i.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(n),o.raw.browser[i.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(n),o.raw.device[t.ANDROID]=/\bAndroid\b/.test(n),o.raw.device[t.IPAD]=/\biPad\b/.test(n),o.raw.device[t.IPHONE]=/\biPhone\b/.test(n),o.raw.device[t.IPOD]=/\biPod\b/.test(n),o.raw.device[t.BLACKBERRY]=/\bblackberry\b/.test(n),o.raw.device[t.FIREFOXOS]=/\bFirefox\b/.test(n)&&/\Mobile\b/.test(n),o.raw.device[t.WINDOWSPHONE]=/\bIEMobile\b/.test(n),o.raw.device[t.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(n),o.raw.device[t.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(n),o.os=[r.WINDOWS,r.IOS,r.MAC,r.ANDROID,r.LINUX,r.UNIX,r.FIREFOXOS,r.WINDOWSPHONE,r.PS4,r.VITA].reduce(function(e,t){return e===r.UNKNOWN&&o.raw.os[t]?t:e},r.UNKNOWN),o.browser=[i.CHROME,i.FIREFOX,i.SAFARI,i.OPERA,i.IE,i.PS4,i.VITA].reduce(function(e,t){return e===i.UNKNOWN&&o.raw.browser[t]?t:e},i.UNKNOWN),o.device=[t.ANDROID,t.IPAD,t.IPHONE,t.IPOD,t.BLACKBERRY,t.FIREFOXOS,t.WINDOWSPHONE,t.PS4,t.VITA].reduce(function(e,i){return e===t.UNKNOWN&&o.raw.device[i]?i:e},t.UNKNOWN),o.isMobile=function(){return[t.ANDROID,t.IPAD,t.IPHONE,t.IPOD,t.BLACKBERRY,t.FIREFOXOS,t.WINDOWSPHONE,t.VITA].some(function(e){return o.device==e})},o.isTablet=function(){return[t.IPAD,t.FIREFOXOS].some(function(e){return o.device==e})},o.isDesktop=function(){return[t.PS4,t.UNKNOWN].some(function(e){return o.device==e})},o}]).directive("deviceDetector",["deviceDetector",function(e){return{restrict:"A",link:function(t,i){i.addClass("os-"+e.os),i.addClass("browser-"+e.browser),i.addClass("device-"+e.device)}}}])}(angular),angular.module("tritonFeedback",["ngCookies","ng.deviceDetector","firebase"]),angular.module("tritonFeedback").controller("mainCtrl",["$scope","$cookies","tritonFeedbackData","deviceDetector","firebaseManager",function(e,t,i,r,n){"use strict";var o=this;e.authenticated=!1,e.visible=!1,e.env={browser:r.browser,device:r.device,os:r.os},e.path=window.location.pathname,e.error=!1,e.firebase=n,e.feedback={},e.wp=null,this.authenticate=function(e){var t=e.triton_feedback_access;return t?!0:!1},this.connect=function(e){var t=new Firebase("https://"+e+".firebaseio.com/");return t?t:null},e.getTemplate=function(){return o.authenticated?e.wp.templateUrl:""},e.open=function(){e.visible=!0,angular.element(document.getElementsByTagName("body")).css("overflow","hidden")},e.close=function(){e.visible=!1,angular.element(document.getElementsByTagName("body")).css("overflow","")},e.submitFeedback=function(){var i=e.firebase.push({time:(new Date).getTime(),session:t.triton_feedback_session,browser:e.env.browser,device:e.env.device,os:e.env.os,path:e.path,message:e.feedback.message},e.callback);i||e["throw"]()},e.callback=function(t){e.$apply(t?e.error():e.resetFeedback())},e["throw"]=function(){e.error=!0},e.resetFeedback=function(){e.feedback={}},this.init=function(){o.authenticated=o.authenticate(t),o.authenticated&&(e.wp=i,e.firebase.connect()||e["throw"]())},this.init()}]),angular.module("tritonFeedback").factory("tritonFeedbackData",function(){"use strict";return this.defaults={templateUrl:"wp-content/plugins/triton-feedback/src/template.html",firebase:""},"undefined"==typeof tritonFeedbackData?this.defaults:tritonFeedbackData}),angular.module("tritonFeedback").service("firebaseManager",["tritonFeedbackData",function(e){"use strict";var t=this;this.firebaseName=e.firebase,this.connected=!1,this.connect=function(){if(!t.firebaseName)return!1;var e=new Firebase("https://"+t.firebaseName+".firebaseio.com/");return e?(t.connected=!0,!0):!1},this.push=function(e,i){if(!t.connected)return!1;var r=connection.child("tickets");return r.push({time:(new Date).getTime(),session:$cookies.triton_feedback_session,browser:$scope.env.browser,device:$scope.env.device,os:$scope.env.os,path:$scope.path,message:$scope.feedback.message},i),!0}}]),angular.bootstrap(document.getElementById("triton-feedback"),["tritonFeedback"]);