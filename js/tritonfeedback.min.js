!function(e){"use strict";e.module("ng.deviceDetector",[]).constant("BROWSERS",{CHROME:"chrome",FIREFOX:"firefox",SAFARI:"safari",OPERA:"opera",IE:"ie",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("DEVICES",{ANDROID:"android",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",BLACKBERRY:"blackberry",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("OS",{WINDOWS:"windows",MAC:"mac",IOS:"ios",ANDROID:"android",LINUX:"linux",UNIX:"unix",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).service("detectUtils",["deviceDetector","DEVICES","BROWSERS","OS",function(e,t,n,i){var r=e;this.isMobile=function(){return"unknown"!==r.device},this.isAndroid=function(){return r.device===t.ANDROID||r.OS===i.ANDROID},this.isIOS=function(){return r.os===i.IOS||r.device===t.IPOD||r.device===t.IPHONE}}]).factory("deviceDetector",["$window","DEVICES","BROWSERS","OS",function(e,t,n,i){var r=e.navigator.userAgent,o={raw:{userAgent:r,os:{},browser:{},device:{}}};return o.raw.os[i.WINDOWS]=/\bWindows\b/.test(r)&&!/\bWindows Phone\b/.test(r),o.raw.os[i.MAC]=/\bMac OS\b/.test(r),o.raw.os[i.IOS]=/\biPad\b/.test(r)||/\biPhone\b/.test(r)||/\biPod\b/.test(r),o.raw.os[i.ANDROID]=/\bAndroid\b/.test(r),o.raw.os[i.LINUX]=/\bLinux\b/.test(r),o.raw.os[i.UNIX]=/\bUNIX\b/.test(r),o.raw.os[i.FIREFOXOS]=/\bFirefox\b/.test(r)&&/\Mobile\b/.test(r),o.raw.os[i.WINDOWSPHONE]=/\bIEMobile\b/.test(r),o.raw.os[i.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(r),o.raw.os[i.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(r),o.raw.browser[n.CHROME]=/\bChrome\b/.test(r)||/\bCriOS\b/.test(r),o.raw.browser[n.FIREFOX]=/\Firefox\b/.test(r),o.raw.browser[n.SAFARI]=/^((?!CriOS).)*\Safari\b.*$/.test(r),o.raw.browser[n.OPERA]=/\Opera\b/.test(r),o.raw.browser[n.IE]=/\bMSIE\b/.test(r)||/\Trident\b/.test(r),o.raw.browser[n.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(r),o.raw.browser[n.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(r),o.raw.device[t.ANDROID]=/\bAndroid\b/.test(r),o.raw.device[t.IPAD]=/\biPad\b/.test(r),o.raw.device[t.IPHONE]=/\biPhone\b/.test(r),o.raw.device[t.IPOD]=/\biPod\b/.test(r),o.raw.device[t.BLACKBERRY]=/\bblackberry\b/.test(r),o.raw.device[t.FIREFOXOS]=/\bFirefox\b/.test(r)&&/\Mobile\b/.test(r),o.raw.device[t.WINDOWSPHONE]=/\bIEMobile\b/.test(r),o.raw.device[t.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(r),o.raw.device[t.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(r),o.os=[i.WINDOWS,i.IOS,i.MAC,i.ANDROID,i.LINUX,i.UNIX,i.FIREFOXOS,i.WINDOWSPHONE,i.PS4,i.VITA].reduce(function(e,t){return e===i.UNKNOWN&&o.raw.os[t]?t:e},i.UNKNOWN),o.browser=[n.CHROME,n.FIREFOX,n.SAFARI,n.OPERA,n.IE,n.PS4,n.VITA].reduce(function(e,t){return e===n.UNKNOWN&&o.raw.browser[t]?t:e},n.UNKNOWN),o.device=[t.ANDROID,t.IPAD,t.IPHONE,t.IPOD,t.BLACKBERRY,t.FIREFOXOS,t.WINDOWSPHONE,t.PS4,t.VITA].reduce(function(e,n){return e===t.UNKNOWN&&o.raw.device[n]?n:e},t.UNKNOWN),o.isMobile=function(){return[t.ANDROID,t.IPAD,t.IPHONE,t.IPOD,t.BLACKBERRY,t.FIREFOXOS,t.WINDOWSPHONE,t.VITA].some(function(e){return o.device==e})},o.isTablet=function(){return[t.IPAD,t.FIREFOXOS].some(function(e){return o.device==e})},o.isDesktop=function(){return[t.PS4,t.UNKNOWN].some(function(e){return o.device==e})},o}]).directive("deviceDetector",["deviceDetector",function(e){return{restrict:"A",link:function(t,n){n.addClass("os-"+e.os),n.addClass("browser-"+e.browser),n.addClass("device-"+e.device)}}}])}(angular),angular.module("tritonFeedback",["ngCookies","ng.deviceDetector","firebase"]),angular.module("tritonFeedback").controller("mainCtrl",["$scope","$cookies","tritonFeedbackData","deviceDetector","firebaseManager","$timeout",function(e,t,n,i,r,o){"use strict";var a=this;e.authenticated=!1,e.visible=!1,e.showConfirmation=!1,e.env={browser:i.browser,device:i.device,os:i.os},e.path=window.location.pathname,e.error=!1,e.firebase=r,e.feedback={message:null,category:"broken"},e.wp=null,e.feedbackCategories=["broken","awesome","surprising","confusing","annoying","other"],this.authenticate=function(e){var t=e.triton_feedback_access;return t?!0:!1},this.connect=function(e){var t=new Firebase("https://"+e+".firebaseio.com/");return t?t:null},e.getTemplate=function(){return a.authenticated?e.wp.templateUrl:""},e.open=function(){e.visible=!0,angular.element(document.getElementsByTagName("body")).css("overflow","hidden")},e.close=function(){e.visible=!1,angular.element(document.getElementsByTagName("body")).css("overflow","")},e.submitFeedback=function(){var n=e.firebase.push({time:(new Date).getTime(),session:t.triton_feedback_session,browser:e.env.browser,device:e.env.device,os:e.env.os,path:e.path,message:e.feedback.message,category:e.feedback.category},e.callback);n||e["throw"]()},e.callback=function(t){e.$apply(t?e.error():e.resetFeedback())},e["throw"]=function(){e.error=!0},e.resetFeedback=function(){e.feedback={message:null,category:"broken"},e.showConfirmation=!0,o(function(){e.showConfirmation=!1},5e3)},this.init=function(){if(a.authenticated=a.authenticate(t),a.authenticated){e.wp=n;var i=e.firebase.connect();i||e["throw"]()}},this.init()}]),angular.module("tritonFeedback").factory("tritonFeedbackData",function(){"use strict";return this.defaults={templateUrl:"wp-content/plugins/triton-feedback/src/template.html",firebase:""},"undefined"==typeof tritonFeedbackData?this.defaults:tritonFeedbackData}),angular.module("tritonFeedback").service("firebaseManager",["tritonFeedbackData","$cookies",function(e){"use strict";var t=this;this.firebaseName=e.firebase,this.connection=null,this.connected=!1,this.connect=function(){return t.firebaseName?(t.connection=new Firebase("https://"+t.firebaseName+".firebaseio.com/"),t.connection?!0:!1):!1},this.push=function(e,n){if(!t.connection)return!1;var i=t.connection.child("tickets");return i.push(e,n),!0}}]),angular.bootstrap(document.getElementById("triton-feedback"),["tritonFeedback"]);